<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Catatanku Ultimate+ Touch</title>

<link href="https://fonts.googleapis.com/css2?family=Indie+Flower&family=Noto+Sans+Thai:wght@500&display=swap" rel="stylesheet">

<style>
* { box-sizing: border-box; transition: all 0.3s ease; }
body {
  margin: 0; padding: 0;
  font-family: 'Noto Sans Thai', sans-serif;
  min-height: 100vh;
  display: flex; align-items: center; justify-content: center;
  background: linear-gradient(135deg, #87CEFA, #FFFACD);
}

/* Welcome */
.welcome { text-align: center; animation: fadeIn 1s ease; padding:20px; }
.welcome h1 {
  font-family: 'Indie Flower', cursive;
  font-size: 60px; color: #004aad; margin-bottom: 15px;
}
.welcome button {
  background: #FFD700; color: #333; border: none;
  padding: 12px 28px; border-radius: 25px;
  font-weight: 600; cursor: pointer;
}
.welcome button:hover { background: #FFC107; transform: scale(1.05); }

/* App */
.app { display: none; width: 95%; max-width: 900px;
  background: rgba(255,255,255,0.95); border-radius: 20px; padding: 25px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.2); animation: fadeIn 0.8s ease;
}
h2 { font-family: 'Indie Flower', cursive; color: #0077cc; text-align:center; margin-top:0; }
textarea {
  width: 100%; border: 2px dashed #0077cc;
  border-radius: 10px; padding: 12px; font-size: 15px;
  background: #f0faff; resize: none; margin-bottom: 10px;
}

.controls, .emoji-board { display: flex; flex-wrap: wrap; gap: 10px; margin: 12px 0; }

button.action {
  border: none; border-radius: 8px; padding: 10px 16px;
  font-weight: 600; cursor: pointer; color: white;
}
.save { background: #007bff; }
.clear { background: #6c757d; }
.export { background: #28a745; }
.draw { background: #FFD700; color: #333; }
.clear-images { background: #FF4500; }

.save:hover { background: #0056b3; }
.clear:hover { background: #5a6268; }
.export:hover { background: #218838; }
.draw:hover { background: #FFC107; }
.clear-images:hover { background: #E03E00; }

input[type="color"], input[type="range"], select { cursor: pointer; }

canvas {
  border: 2px solid #0077cc; border-radius: 12px; background: #ffffff;
  cursor: crosshair; display: block; margin: 0 auto 15px auto;
  touch-action: none;
}

.note {
  background: #f0faff; border-left: 5px solid #0077cc;
  border-radius: 10px; padding: 10px; margin-top: 10px; position: relative;
}
.note button.delete-image {
  position: absolute; top: 10px; right: 10px;
  background: #FF4500; border: none; border-radius: 5px; padding: 2px 6px;
  color: white; cursor: pointer;
}
.note button.delete-image:hover { background: #E03E00; }

.timestamp { font-size: 12px; color:#777; text-align:right; }

.emoji-board button { font-size: 24px; padding: 6px 10px; border-radius: 8px; border: 1px solid #ccc; cursor: pointer; background: #fff; }
.emoji-board button:hover { transform: scale(1.2); }

@keyframes fadeIn {
  from { opacity:0; transform: translateY(20px); }
  to { opacity:1; transform: translateY(0); }
}
</style>
</head>

<body>
<div class="welcome" id="welcome">
  <h1>Catatanku Ultimate+ üé®</h1>
  <p>Catat, gambar, dan tambahkan emoji sesuai kreativitasmu üíõ</p>
  <button onclick="startApp()">Mulai Berkreasi</button>
</div>

<div class="app" id="app">
  <h2>Catatanku Ultimate+</h2>
  <textarea id="note-input" placeholder="Tulis catatanmu di sini..."></textarea>

  <div class="controls">
    <label>üé® Warna Kuas: <input type="color" id="color" value="#007bff"></label>
    <label>üñåÔ∏è Ukuran Kuas: <input type="range" id="size" min="1" max="20" value="3"></label>
    <label>üåà Motif Latar:
      <select id="background">
        <option value="linear-gradient(135deg, #87CEFA, #FFFACD)">Gradient</option>
        <option value="repeating-linear-gradient(45deg,#FFFACD,#FFFACD 20px,#87CEFA 20px,#87CEFA 40px)">Polkadot</option>
        <option value="linear-gradient(135deg,#00BFFF,#FFFACD)">Wave</option>
      </select>
    </label>
  </div>

  <div class="emoji-board">
    <button onclick="addEmoji('üòÄ')">üòÄ</button>
    <button onclick="addEmoji('üéâ')">üéâ</button>
    <button onclick="addEmoji('‚ù§Ô∏è')">‚ù§Ô∏è</button>
    <button onclick="addEmoji('üí°')">üí°</button>
    <button onclick="addEmoji('üå∏')">üå∏</button>
  </div>

  <div class="buttons">
    <button class="action save" id="save-btn">üíæ Simpan</button>
    <button class="action draw" id="draw-toggle">üñåÔ∏è Gambar</button>
    <button class="action export" id="export-btn">üì§ Ekspor Gambar</button>
    <button class="action clear" id="clear-all">üóëÔ∏è Hapus Semua</button>
    <button class="action clear-images" id="clear-images">üóëÔ∏è Hapus Semua Gambar</button>
  </div>

  <canvas id="canvas" width="750" height="400"></canvas>
  <div id="notes-list"></div>
</div>

<script>
const welcome = document.getElementById('welcome');
const app = document.getElementById('app');
const input = document.getElementById('note-input');
const saveBtn = document.getElementById('save-btn');
const clearAllBtn = document.getElementById('clear-all');
const clearImagesBtn = document.getElementById('clear-images');
const exportBtn = document.getElementById('export-btn');
const drawBtn = document.getElementById('draw-toggle');
const colorPicker = document.getElementById('color');
const sizePicker = document.getElementById('size');
const bgPicker = document.getElementById('background');
const notesList = document.getElementById('notes-list');
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

let drawing = false;
let notes = JSON.parse(localStorage.getItem('ultimateNotes')) || [];

function startApp(){
  welcome.style.display='none';
  app.style.display='block';
}

function saveNotes(){
  localStorage.setItem('ultimateNotes', JSON.stringify(notes));
}

function formatDate(){
  const now=new Date();
  return now.toLocaleString('id-ID',{day:'2-digit',month:'long',year:'numeric',hour:'2-digit',minute:'2-digit'});
}

function canvasBlank(){
  const blank = document.createElement('canvas');
  blank.width = canvas.width;
  blank.height = canvas.height;
  return blank.toDataURL();
}

function renderNotes(){
  notesList.innerHTML='';
  if(notes.length===0){
    notesList.innerHTML='<p style="text-align:center;color:#555;">Belum ada catatan üé®</p>';
    return;
  }
  notes.forEach((n,i)=>{
    const div=document.createElement('div');
    div.className='note';
    let inner = '';
    if(n.text) inner += `<p>${n.text}</p>`;
    if(n.image && n.image!==canvasBlank()) inner += `<img src="${n.image}" width="100%" style="border-radius:10px;margin-top:8px;">`;
    inner += `<div class="timestamp">${n.time}</div>`;
    div.innerHTML = inner;

    if(n.image && n.image!==canvasBlank()){
      const btn = document.createElement('button');
      btn.className='delete-image';
      btn.innerText='‚ùå';
      btn.onclick = ()=>{
        n.image = canvasBlank();
        saveNotes(); renderNotes();
      };
      div.appendChild(btn);
    }

    notesList.appendChild(div);
  });
}

function addEmoji(e){ input.value += e; }

saveBtn.addEventListener('click',()=>{
  notes.push({ text: input.value, image: canvas.toDataURL(), time: formatDate() });
  input.value=''; ctx.clearRect(0,0,canvas.width,canvas.height);
  saveNotes(); renderNotes();
});

clearAllBtn.addEventListener('click',()=>{
  if(confirm('Hapus semua catatan?')){ notes=[]; saveNotes(); ctx.clearRect(0,0,canvas.width,canvas.height); renderNotes(); }
});

clearImagesBtn.addEventListener('click',()=>{
  if(confirm('Hapus semua gambar?')){ notes = notes.map(n=>({...n,image:canvasBlank()})); saveNotes(); renderNotes(); }
});

drawBtn.addEventListener('click',()=>{
  canvas.style.display = canvas.style.display==='none'?'block':'none';
});

exportBtn.addEventListener('click',()=>{
  const link=document.createElement('a');
  link.download='my-drawing.png';
  link.href=canvas.toDataURL();
  link.click();
});

// ==================== DRAWING (mouse & touch) ====================
canvas.addEventListener('mousedown',()=>{ drawing=true; ctx.beginPath(); });
canvas.addEventListener('mouseup',()=>{ drawing=false; ctx.closePath(); });
canvas.addEventListener('mousemove', drawMouse);

canvas.addEventListener('touchstart',(e)=>{
  e.preventDefault(); drawing=true;
  const touch=e.touches[0]; const rect=canvas.getBoundingClientRect();
  ctx.beginPath(); ctx.moveTo(touch.clientX-rect.left, touch.clientY-rect.top);
});
canvas.addEventListener('touchmove',(e)=>{
  e.preventDefault(); if(!drawing) return;
  const touch=e.touches[0]; const rect=canvas.getBoundingClientRect();
  ctx.lineWidth=sizePicker.value;
  ctx.strokeStyle=colorPicker.value;
  ctx.lineCap='round';
  ctx.lineTo(touch.clientX-rect.left, touch.clientY-rect.top);
  ctx.stroke();
  ctx.beginPath(); ctx.moveTo(touch.clientX-rect.left, touch.clientY-rect.top);
});
canvas.addEventListener('touchend',(e)=>{ e.preventDefault(); drawing=false; ctx.closePath(); });

function drawMouse(e){
  if(!drawing) return;
  const rect=canvas.getBoundingClientRect();
  ctx.lineWidth=sizePicker.value;
  ctx.strokeStyle=colorPicker.value;
  ctx.lineCap='round';
  ctx.lineTo(e.clientX-rect.left, e.clientY-rect.top);
  ctx.stroke();
  ctx.beginPath();
  ctx.moveTo(e.clientX-rect.left, e.clientY-rect.top);
}

bgPicker.addEventListener('change',()=>{ app.style.background=bgPicker.value; canvas.style.background=bgPicker.value; });

canvas.style.display='none';
renderNotes();
</script>

</body>
</html>
